(window.webpackJsonpQuestBook=window.webpackJsonpQuestBook||[]).push([[0],{119:function(e,t,n){"use strict";var a=n(18),o=n(16),i=n(23),r=n(24),s=n(25),l=n(0),u=n.n(l),c=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){if(""!==this.props.text)return u.a.createElement("div",{style:this.getStyle()},u.a.createElement("p",null,this.props.text))}},{key:"getStyle",value:function(){return{flex:.5,marginLeft:"1%",marginRight:"1%",marginTop:"1%",backgroundColor:"#FFFBF2",color:"#4D708B",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",borderRadius:"5px",padding:"1%",textAlign:"width"}}}]),t}(u.a.Component);t.a=c},278:function(module,__webpack_exports__,__webpack_require__){"use strict";var _Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(18),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(23),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(24),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(27),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(25),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__),_QuestPage__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(287),_TextBox__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(119),request__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(144),request__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(request__WEBPACK_IMPORTED_MODULE_9__),Quest=function(_React$Component){function Quest(e){var t;return Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,Quest),(t=Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__.a)(this,Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__.a)(Quest).call(this,e))).download(t.props.id,(function(e){console.log("ALLO"),console.log(e);var n="{";e.globals.forEach((function(e,t){0!==t&&(n+=",");var a=JSON.stringify({type:e.type,justifyName:e.justifyName,value:e.value});n+='"'.concat(e.varName,'" : ').concat(a)})),n+="}",t.setState({model:e,globals:JSON.parse(n),index:e.startNode,isReady:!0})})),t.onRestart=t.onRestart.bind(Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__.a)(t)),t.onExit=t.onExit.bind(Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__.a)(t)),t}return Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__.a)(Quest,_React$Component),Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(Quest,[{key:"download",value:function(e,t){__webpack_require__(144)("https://questbook.evarand.rocks/api/quest/".concat(e,"/"),(function(e,n,a){console.error("error:",e),console.log("statusCode:",n&&n.statusCode),console.log("body:",a),t(JSON.parse(JSON.parse(a).data))}))}},{key:"execUntilBaseNode",value:function execUntilBaseNode(index){var node=this.getNode(index);if(this.isBaseNode(node))return node;var evalAns=eval(node.code);if(1===node.links.length)return this.execUntilBaseNode(node.links[0].to);if(node.isBranching){var newNodeIndex=node.links.filter((function(e){return e.transition===evalAns}))[0].to;return this.execUntilBaseNode(newNodeIndex)}var changeVariable=function(e,t){JSON.parse(JSON.stringify(e)).k=t};return this.setState((function(e){return{globals:changeVariable(e,e.globals.k+1)}})),this.execUntilBaseNode(evalAns)}},{key:"isBaseNode",value:function(e){return!("undefined"===typeof e.text)}},{key:"getNode",value:function(e){return this.state.model.nodes[e]}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps,prevState,snapshot){var curNode=this.getNode(this.state.index);if(!this.isBaseNode(curNode)){var evalAns=eval(curNode.code);if(1===curNode.links.length)this.setState({index:curNode.links[0].to});else if(curNode.isBranching){console.log("we in Branch!");var newNodeIndex=curNode.links.filter((function(e){return e.transition===evalAns}))[0].to;this.setState({index:newNodeIndex})}else this.setState({index:evalAns})}}},{key:"render",value:function(){var e=this;if(null!==this.state){var t=this.state.model.goodNodes.some((function(t){return t===e.state.index})),n=this.state.model.badNodes.some((function(t){return t===e.state.index})),a=new Array;if(n){var o={text:"\u041f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c",action:this.onRestart};a.push(o)}if(t||n){var i={text:"\u0412\u044b\u0439\u0442\u0438",action:this.onExit};a.push(i)}var r=this.getNode(this.state.index),s=this.state.globals,l=new Array;for(var u in s)l.push(s[u]);if(this.isBaseNode(r)){var c=r.links.map((function(t){var n=t.transition,a=t.to;return{text:n,action:function(){var t=e.execUntilBaseNode(a);e.setState({index:t.id})}}})),_={text:r.text,image:r.pic,actions:c,input:r.input,globals:l,isLast:t||n,endpointActions:a};return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_QuestPage__WEBPACK_IMPORTED_MODULE_7__.a,{node:_}))}return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_TextBox__WEBPACK_IMPORTED_MODULE_8__.a,null))}return null}},{key:"onRestart",value:function(){this.setState({index:this.state.model.startNode})}},{key:"onExit",value:function(){this.props.onBackButtonClick()}}]),Quest}(react__WEBPACK_IMPORTED_MODULE_6___default.a.Component);__webpack_exports__.a=Quest},287:function(e,t,n){"use strict";var a=n(18),o=n(16),i=n(23),r=n(24),s=n(27),l=n(25),u=n(0),c=n.n(u),_=n(119),d=n(716),p=n(719),h=n(720),m=n(281),b=n.n(m),f=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.a.createElement(d.a,{button:!0,alignItems:"flex-start",onClick:this.props.action,style:this.getStyle()},c.a.createElement(p.a,null,c.a.createElement(b.a,{fontSize:"inherit",style:{color:"#4D708B"}})),c.a.createElement(h.a,{primary:this.props.text}))}},{key:"getStyle",value:function(){return{color:"#AC9357"}}}]),t}(c.a.Component),y=n(721),k=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.actions.map((function(e){return c.a.createElement("div",{key:e.text},c.a.createElement(f,{text:e.text,action:e.action}),c.a.createElement(y.a,{variant:"inset"}))}));return c.a.createElement("div",{style:this.getStyle()},e)}},{key:"getStyle",value:function(){return{display:"flex",flexDirection:"column",marginLeft:"1%",marginRight:"1%",marginTop:"1%",marginBottom:"1%",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",backgroundColor:"#EFE9DB",borderRadius:"5px"}}}]),t}(c.a.Component),E=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.a.createElement("img",{style:this.getStyle(),src:this.props.image})}},{key:"getStyle",value:function(){return{marginLeft:"1%",marginRight:"1%",marginTop:"1%",border:"1px solid black",borderRadius:"5px",backgroundColor:"#384649",flex:1,alignSelf:"stretch",objectFit:"contain",height:"100%",width:"97.7%"}}}]),t}(c.a.Component),v=n(282),O=n.n(v),g=n(722),x=n(5),B=n(42),C=n(283),S=n.n(C),D=Object(x.a)({root:{height:10,backgroundColor:Object(B.d)("#4D708B",.75),borderRadius:20},bar:{borderRadius:20,backgroundColor:"#4D708B"}})(g.a),j=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("h1",{style:this.mainHeaderStyle()},"\u0418\u043d\u0444\u043e"),c.a.createElement("div",{style:this.getStyle()},this.parseGlobals(this.props.globals)))}},{key:"parseGlobals",value:function(e){var t=this;return e.map((function(e){return t.parseGlobal(e)}))}},{key:"parseGlobal",value:function(e){var t=this;if(0===e.type||2===e.type)return c.a.createElement("h3",{key:e.justifyName},e.justifyName,": ",e.value);if(1===e.type)return c.a.createElement("div",{key:e.justifyName},c.a.createElement("h3",null,e.justifyName,":"),c.a.createElement(D,{variant:"determinate",color:"secondary",value:e.value}));if(3===e.type){var n=e.value.map((function(e){return c.a.createElement("div",{key:e,style:t.itemStyle()},c.a.createElement(d.a,{button:!0},c.a.createElement(p.a,null,c.a.createElement(S.a,null)),c.a.createElement(h.a,{primary:e})))}));return c.a.createElement("div",{key:e.justifyName,style:this.itemsListStyle()},c.a.createElement("h3",null,e.justifyName,":"),n)}}},{key:"itemStyle",value:function(){return{display:"flex",flexDirection:"row",flex:1,flexWrap:"nowrap"}}},{key:"itemsListStyle",value:function(){return{display:"flex",flexDirection:"column"}}},{key:"mainHeaderStyle",value:function(){return{textAlign:"center",color:"#4D708B"}}},{key:"getStyle",value:function(){return{flex:1,flexDirection:"column",marginLeft:"1%",marginRight:"1%",marginTop:"1%",backgroundColor:"#FFFBF2",color:"#4D708B",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",borderRadius:"5px",padding:"1%",textAlign:"width"}}}]),t}(c.a.Component),w=n(726),M=function(e){function t(){var e;return Object(a.a)(this,t),(e=Object(i.a)(this,Object(r.a)(t).call(this))).state={text:"",answer:""},e.setStateInner=e.setStateInner.bind(Object(s.a)(e)),e}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.setState({answer:this.props.answer})}},{key:"render",value:function(){var e=this;return c.a.createElement(w.a,{id:"standard-multiline-flexible",label:"\u041e\u0442\u0432\u0435\u0442",multiline:!0,rowsMax:"4",value:this.state.text,onChange:function(t){return e.setStateInner(t)},style:this.inputStyle(),margin:"normal"})}},{key:"inputStyle",value:function(){return{backgroundColor:"#FFFBF2",color:"#4D708B",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",borderRadius:"5px",padding:"1%"}}},{key:"setStateInner",value:function(e){this.setState({text:e.target.value}),e.target.value===this.state.answer&&this.props.onCheckSuccess()}}]),t}(c.a.Component),P=function(e){function t(){var e;return Object(a.a)(this,t),(e=Object(i.a)(this,Object(r.a)(t).call(this))).state={inInventory:!1},e.onSwipeMove=e.onSwipeMove.bind(Object(s.a)(e)),e.onCheckInputSuccess=e.onCheckInputSuccess.bind(Object(s.a)(e)),e}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.setState({actions:this.props.node.actions})}},{key:"render",value:function(){console.log(this.props.node);var e=this.props.node.isLast?this.props.node.endpointActions:this.props.node.actions,t=this.state.inInventory?c.a.createElement("div",{style:this.getStyle()},null!=this.props.node.image?c.a.createElement(E,{image:this.props.node.image}):null,c.a.createElement(j,{globals:this.props.node.globals})):c.a.createElement("div",{style:this.getStyle()},null!=this.props.node.image?c.a.createElement(E,{image:this.props.node.image}):null,c.a.createElement(_.a,{text:this.props.node.text}),null!=this.props.node.input?c.a.createElement(M,{onCheckSuccess:this.onCheckInputSuccess,answer:this.props.node.input}):c.a.createElement(k,{actions:e}));return c.a.createElement(O.a,{onSwipeStart:this.onSwipeStart,onSwipeMove:this.onSwipeMove,onSwipeEnd:this.onSwipeEnd},t)}},{key:"getStyle",value:function(){return{height:"auto",display:"flex",flex:1,flexDirection:"column",justifyContent:"flex-start space-around",alignItems:"space-around",alignContent:"space-around"}}},{key:"onCheckInputSuccess",value:function(){0!==this.state.actions.length&&this.state.actions[0].action()}},{key:"onSwipeStart",value:function(e){}},{key:"onSwipeEnd",value:function(e){}},{key:"onSwipeMove",value:function(e,t){var n=window.innerWidth/8;e.x<-n&&!this.state.inInventory?this.setState({inInventory:!0}):e.x>n&&this.state.inInventory&&this.setState({inInventory:!1})}}]),t}(c.a.Component);t.a=P},371:function(e,t,n){e.exports=n(682)},468:function(e,t){},470:function(e,t){},502:function(e,t){},503:function(e,t){},547:function(e,t){},549:function(e,t){},572:function(e,t){},682:function(e,t,n){"use strict";n.r(t);n(372),n(398),n(400),n(401),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440);var a=n(0),o=n.n(a),i=n(19),r=n.n(i),s=n(277),l=n.n(s),u=n(18),c=n(16),_=n(23),d=n(24),p=n(27),h=n(25),m=(n(448),n(278)),b=n(286),f=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(_.a)(this,Object(d.a)(t).call(this))).onClick=e.onClick.bind(Object(p.a)(e)),e}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{style:this.getStyle()},o.a.createElement("h1",null,this.props.header),o.a.createElement("p",null,this.props.desc),o.a.createElement(b.a,{onClick:this.onClick,style:this.getBtnStyle()},"Start"))}},{key:"onClick",value:function(){this.props.onButtonClick(this.props.id)}},{key:"getBtnStyle",value:function(){return{flex:1,color:"#FFB954",backgroundColor:"#384649",textAlign:"center"}}},{key:"getStyle",value:function(){return{display:"flex",flexDirection:"column",textAlign:"center",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",borderRadius:"5px",backgroundColor:"#EFE9DB",padding:"1%",margin:"1%"}}}]),t}(o.a.Component),y=function(e){function t(){return Object(u.a)(this,t),Object(_.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.buttons.map((function(t){return o.a.createElement(f,{key:t.id,header:t.text,desc:t.description,onButtonClick:e.props.onButtonClick,id:t.id})}));return o.a.createElement("div",{style:this.getStyle()},t)}},{key:"getStyle",value:function(){return{height:"auto",display:"flex",flexDirection:"column",justifyContent:"space-around",alignContent:"space-around"}}}]),t}(o.a.Component),k=n(725),E=n(723),v=n(130),O=n(285),g=n.n(O),x=n(724),B=n(284),C=n.n(B),S=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(_.a)(this,Object(d.a)(t).call(this))).download((function(t){console.log("ALLO"),console.log(t),e.setState({quests:t,isReady:!0,currentQuestId:""})})),e.onButtonClick=e.onButtonClick.bind(Object(p.a)(e)),e.onBackButtonClick=e.onBackButtonClick.bind(Object(p.a)(e)),e}return Object(h.a)(t,e),Object(c.a)(t,[{key:"download",value:function(e){n(144)("https://questbook.evarand.rocks/api/quests",(function(t,n,a){console.error("error:",t),console.log("statusCode:",n&&n.statusCode),console.log("body:",a),e(JSON.parse(a))}))}},{key:"render",value:function(){if(null===this.state)return null;var e=C()((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),t=""!==this.state.currentQuestId?o.a.createElement(E.a,{edge:"start",onClick:this.onBackButtonClick,className:e.menuButton,color:"inherit","aria-label":"menu"},o.a.createElement(g.a,null)):null,n=""===this.state.currentQuestId?o.a.createElement(y,{buttons:this.state.quests,onButtonClick:this.onButtonClick}):o.a.createElement(m.a,{onBackButtonClick:this.onBackButtonClick,id:this.state.currentQuestId});return o.a.createElement("div",{style:this.getStyle()},o.a.createElement(x.a,{position:"sticky",style:{backgroundColor:"#4D708B"}},o.a.createElement(k.a,null,t,o.a.createElement(v.a,{variant:"h6",className:e.title},"QuestBook"))),n)}},{key:"onBackButtonClick",value:function(){this.onButtonClick("")}},{key:"onButtonClick",value:function(e){this.setState({currentQuestId:e})}},{key:"getStyle",value:function(){return{background:"radial-gradient(#D6C594, #938B6A)",height:"auto",minHeight:"100vh"}}}]),t}(o.a.Component);l.a.send("VKWebAppInit"),r.a.render(o.a.createElement(S,null),document.getElementById("root"))}},[[371,1,2]]]);
//# sourceMappingURL=main.5157cdcd.chunk.js.map