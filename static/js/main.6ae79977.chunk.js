(window.webpackJsonpQuestBook=window.webpackJsonpQuestBook||[]).push([[0],{119:function(e,t,n){"use strict";var a=n(18),i=n(16),o=n(23),r=n(24),s=n(25),l=n(0),c=n.n(l),u=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){if(""!==this.props.text)return c.a.createElement("div",{style:this.getStyle()},c.a.createElement("p",null,this.props.text))}},{key:"getStyle",value:function(){return{flex:.5,marginLeft:"1%",marginRight:"1%",marginTop:"1%",backgroundColor:"#FFFBF2",color:"#4D708B",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",borderRadius:"5px",padding:"1%",textAlign:"width"}}}]),t}(c.a.Component);t.a=u},277:function(module,__webpack_exports__,__webpack_require__){"use strict";var _Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(18),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(16),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(23),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(24),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(27),_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(25),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__),_QuestPage__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(286),_TextBox__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(119),request__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(453),request__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(request__WEBPACK_IMPORTED_MODULE_9__),Quest=function(_React$Component){function Quest(e){var t;Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,Quest);var n=(t=Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__.a)(this,Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__.a)(Quest).call(this,e))).download(t.props.id);console.log(n);var a="{";return n.globals.forEach((function(e,t){0!==t&&(a+=",");var n=JSON.stringify({type:e.type,justifyName:e.justifyName,value:e.value});a+='"'.concat(e.varName,'" : ').concat(n)})),a+="}",t.state={model:null,globals:JSON.parse(a),index:n.startNode},t.onRestart=t.onRestart.bind(Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__.a)(t)),t.onExit=t.onExit.bind(Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4__.a)(t)),t}return Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_5__.a)(Quest,_React$Component),Object(_Users_impy_QuestBook_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(Quest,[{key:"componentDidMount",value:function(){this.download(this.props.id)}},{key:"download",value:function(e){return fetch("https://questbook.evarand.rocks/api/quest/1/").then((function(e){return e.json()})).then((function(e){return e}))}},{key:"execUntilBaseNode",value:function execUntilBaseNode(index){var node=this.getNode(index);if(this.isBaseNode(node))return node;var evalAns=eval(node.code);if(1===node.links.length)return this.execUntilBaseNode(node.links[0].to);if(node.isBranching){var newNodeIndex=node.links.filter((function(e){return e.transition===evalAns}))[0].to;return this.execUntilBaseNode(newNodeIndex)}var changeVariable=function(e,t){JSON.parse(JSON.stringify(e)).k=t};return this.setState((function(e){return{globals:changeVariable(e,e.globals.k+1)}})),this.execUntilBaseNode(evalAns)}},{key:"isBaseNode",value:function(e){return!("undefined"===typeof e.text)}},{key:"getNode",value:function(e){return this.state.model.nodes[e]}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps,prevState,snapshot){var curNode=this.getNode(this.state.index);if(!this.isBaseNode(curNode)){var evalAns=eval(curNode.code);if(1===curNode.links.length)this.setState({index:curNode.links[0].to});else if(curNode.isBranching){console.log("we in Branch!");var newNodeIndex=curNode.links.filter((function(e){return e.transition===evalAns}))[0].to;this.setState({index:newNodeIndex})}else this.setState({index:evalAns})}}},{key:"render",value:function(){var e=this,t=this.state.model.goodNodes.some((function(t){return t===e.state.index})),n=this.state.model.badNodes.some((function(t){return t===e.state.index})),a=new Array;if(n){var i={text:"\u041f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c",action:this.onRestart};a.push(i)}if(t||n){var o={text:"\u0412\u044b\u0439\u0442\u0438",action:this.onExit};a.push(o)}var r=this.getNode(this.state.index),s=this.state.globals,l=new Array;for(var c in s)l.push(s[c]);if(this.isBaseNode(r)){var u=r.links.map((function(t){var n=t.transition,a=t.to;return{text:n,action:function(){var t=e.execUntilBaseNode(a);e.setState({index:t.id})}}})),_={text:r.text,image:r.pic,actions:u,input:r.input,globals:l,isLast:t||n,endpointActions:a};return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_QuestPage__WEBPACK_IMPORTED_MODULE_7__.a,{node:_}))}return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(_TextBox__WEBPACK_IMPORTED_MODULE_8__.a,null))}},{key:"onRestart",value:function(){this.setState({index:this.state.model.startNode})}},{key:"onExit",value:function(){this.props.onBackButtonClick()}}]),Quest}(react__WEBPACK_IMPORTED_MODULE_6___default.a.Component);__webpack_exports__.a=Quest},286:function(e,t,n){"use strict";var a=n(18),i=n(16),o=n(23),r=n(24),s=n(27),l=n(25),c=n(0),u=n.n(c),_=n(119),d=n(716),h=n(719),p=n(720),b=n(280),m=n.n(b),f=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return u.a.createElement(d.a,{button:!0,alignItems:"flex-start",onClick:this.props.action,style:this.getStyle()},u.a.createElement(h.a,null,u.a.createElement(m.a,{fontSize:"inherit",style:{color:"#4D708B"}})),u.a.createElement(p.a,{primary:this.props.text}))}},{key:"getStyle",value:function(){return{color:"#AC9357"}}}]),t}(u.a.Component),y=n(721),k=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.actions.map((function(e){return u.a.createElement("div",{key:e.text},u.a.createElement(f,{text:e.text,action:e.action}),u.a.createElement(y.a,{variant:"inset"}))}));return u.a.createElement("div",{style:this.getStyle()},e)}},{key:"getStyle",value:function(){return{display:"flex",flexDirection:"column",marginLeft:"1%",marginRight:"1%",marginTop:"1%",marginBottom:"1%",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",backgroundColor:"#EFE9DB",borderRadius:"5px"}}}]),t}(u.a.Component),E=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return u.a.createElement("img",{style:this.getStyle(),src:this.props.image})}},{key:"getStyle",value:function(){return{marginLeft:"1%",marginRight:"1%",marginTop:"1%",border:"1px solid black",borderRadius:"5px",backgroundColor:"#384649",flex:1,alignSelf:"stretch",objectFit:"contain",height:"100%",width:"97.7%"}}}]),t}(u.a.Component),g=n(281),v=n.n(g),O=n(722),x=n(5),B=n(42),C=n(282),w=n.n(C),D=Object(x.a)({root:{height:10,backgroundColor:Object(B.d)("#4D708B",.75),borderRadius:20},bar:{borderRadius:20,backgroundColor:"#4D708B"}})(O.a),S=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement("h1",{style:this.mainHeaderStyle()},"\u0418\u043d\u0444\u043e"),u.a.createElement("div",{style:this.getStyle()},this.parseGlobals(this.props.globals)))}},{key:"parseGlobals",value:function(e){var t=this;return e.map((function(e){return t.parseGlobal(e)}))}},{key:"parseGlobal",value:function(e){var t=this;if(0===e.type||2===e.type)return u.a.createElement("h3",{key:e.justifyName},e.justifyName,": ",e.value);if(1===e.type)return u.a.createElement("div",{key:e.justifyName},u.a.createElement("h3",null,e.justifyName,":"),u.a.createElement(D,{variant:"determinate",color:"secondary",value:e.value}));if(3===e.type){var n=e.value.map((function(e){return u.a.createElement("div",{key:e,style:t.itemStyle()},u.a.createElement(d.a,{button:!0},u.a.createElement(h.a,null,u.a.createElement(w.a,null)),u.a.createElement(p.a,{primary:e})))}));return u.a.createElement("div",{key:e.justifyName,style:this.itemsListStyle()},u.a.createElement("h3",null,e.justifyName,":"),n)}}},{key:"itemStyle",value:function(){return{display:"flex",flexDirection:"row",flex:1,flexWrap:"nowrap"}}},{key:"itemsListStyle",value:function(){return{display:"flex",flexDirection:"column"}}},{key:"mainHeaderStyle",value:function(){return{textAlign:"center",color:"#4D708B"}}},{key:"getStyle",value:function(){return{flex:1,flexDirection:"column",marginLeft:"1%",marginRight:"1%",marginTop:"1%",backgroundColor:"#FFFBF2",color:"#4D708B",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",borderRadius:"5px",padding:"1%",textAlign:"width"}}}]),t}(u.a.Component),j=n(726),I=function(e){function t(){var e;return Object(a.a)(this,t),(e=Object(o.a)(this,Object(r.a)(t).call(this))).state={text:"",answer:""},e.setStateInner=e.setStateInner.bind(Object(s.a)(e)),e}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.setState({answer:this.props.answer})}},{key:"render",value:function(){var e=this;return u.a.createElement(j.a,{id:"standard-multiline-flexible",label:"\u041e\u0442\u0432\u0435\u0442",multiline:!0,rowsMax:"4",value:this.state.text,onChange:function(t){return e.setStateInner(t)},style:this.inputStyle(),margin:"normal"})}},{key:"inputStyle",value:function(){return{backgroundColor:"#FFFBF2",color:"#4D708B",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",borderRadius:"5px",padding:"1%"}}},{key:"setStateInner",value:function(e){this.setState({text:e.target.value}),e.target.value===this.state.answer&&this.props.onCheckSuccess()}}]),t}(u.a.Component),M=function(e){function t(){var e;return Object(a.a)(this,t),(e=Object(o.a)(this,Object(r.a)(t).call(this))).state={inInventory:!1},e.onSwipeMove=e.onSwipeMove.bind(Object(s.a)(e)),e.onCheckInputSuccess=e.onCheckInputSuccess.bind(Object(s.a)(e)),e}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.setState({actions:this.props.node.actions})}},{key:"render",value:function(){console.log(this.props.node);var e=this.props.node.isLast?this.props.node.endpointActions:this.props.node.actions,t=this.state.inInventory?u.a.createElement("div",{style:this.getStyle()},null!=this.props.node.image?u.a.createElement(E,{image:this.props.node.image}):null,u.a.createElement(S,{globals:this.props.node.globals})):u.a.createElement("div",{style:this.getStyle()},null!=this.props.node.image?u.a.createElement(E,{image:this.props.node.image}):null,u.a.createElement(_.a,{text:this.props.node.text}),null!=this.props.node.input?u.a.createElement(I,{onCheckSuccess:this.onCheckInputSuccess,answer:this.props.node.input}):u.a.createElement(k,{actions:e}));return u.a.createElement(v.a,{onSwipeStart:this.onSwipeStart,onSwipeMove:this.onSwipeMove,onSwipeEnd:this.onSwipeEnd},t)}},{key:"getStyle",value:function(){return{height:"auto",display:"flex",flex:1,flexDirection:"column",justifyContent:"flex-start space-around",alignItems:"space-around",alignContent:"space-around"}}},{key:"onCheckInputSuccess",value:function(){0!==this.state.actions.length&&this.state.actions[0].action()}},{key:"onSwipeStart",value:function(e){}},{key:"onSwipeEnd",value:function(e){}},{key:"onSwipeMove",value:function(e,t){var n=window.innerWidth/8;e.x<-n&&!this.state.inInventory?this.setState({inInventory:!0}):e.x>n&&this.state.inInventory&&this.setState({inInventory:!1})}}]),t}(u.a.Component);t.a=M},370:function(e,t,n){e.exports=n(682)},468:function(e,t){},470:function(e,t){},502:function(e,t){},503:function(e,t){},547:function(e,t){},549:function(e,t){},572:function(e,t){},682:function(e,t,n){"use strict";n.r(t);n(371),n(397),n(399),n(400),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439);var a=n(0),i=n.n(a),o=n(19),r=n.n(o),s=n(276),l=n.n(s),c=n(18),u=n(16),_=n(23),d=n(24),h=n(27),p=n(25),b=(n(447),n(277)),m=n(285),f=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(_.a)(this,Object(d.a)(t).call(this))).onClick=e.onClick.bind(Object(h.a)(e)),e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{style:this.getStyle()},i.a.createElement("h1",null,this.props.header),i.a.createElement("p",null,this.props.desc),i.a.createElement(m.a,{onClick:this.onClick,style:this.getBtnStyle()},"Start"))}},{key:"onClick",value:function(){this.props.onButtonClick(this.props.id)}},{key:"getBtnStyle",value:function(){return{flex:1,color:"#FFB954",backgroundColor:"#384649",textAlign:"center"}}},{key:"getStyle",value:function(){return{display:"flex",flexDirection:"column",textAlign:"center",border:"1px solid black",boxShadow:"inset 3px 3px 10px #ccc",borderRadius:"5px",backgroundColor:"#EFE9DB",padding:"1%",margin:"1%"}}}]),t}(i.a.Component),y=function(e){function t(){return Object(c.a)(this,t),Object(_.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.buttons.map((function(t){return i.a.createElement(f,{key:t.id,header:t.header,desc:t.desc,onButtonClick:e.props.onButtonClick,id:t.id})}));return i.a.createElement("div",{style:this.getStyle()},t)}},{key:"getStyle",value:function(){return{height:"auto",display:"flex",flexDirection:"column",justifyContent:"space-around",alignContent:"space-around"}}}]),t}(i.a.Component),k=n(725),E=n(723),g=n(130),v=n(284),O=n.n(v),x=n(724),B=n(283),C=n.n(B),w=[{header:"Quest 1",id:"1",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."},{header:"Quest 2",id:"2",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."},{header:"Quest 3",id:"3",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."},{header:"Quest 4",id:"4",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."},{header:"Quest 5",id:"5",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."},{header:"Quest 6",id:"6",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."},{header:"Quest 7",id:"7",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."},{header:"Quest 8",id:"8",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."},{header:"Quest 9",id:"9",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."},{header:"Quest 10",id:"10",desc:"It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout."}],D=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(_.a)(this,Object(d.a)(t).call(this))).state={currentQuestId:""},e.onButtonClick=e.onButtonClick.bind(Object(h.a)(e)),e.onBackButtonClick=e.onBackButtonClick.bind(Object(h.a)(e)),e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=C()((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),t=""!==this.state.currentQuestId?i.a.createElement(E.a,{edge:"start",onClick:this.onBackButtonClick,className:e.menuButton,color:"inherit","aria-label":"menu"},i.a.createElement(O.a,null)):null,n=""===this.state.currentQuestId?i.a.createElement(y,{buttons:w,onButtonClick:this.onButtonClick}):i.a.createElement(b.a,{onBackButtonClick:this.onBackButtonClick,id:this.state.currentQuestId});return i.a.createElement("div",{style:this.getStyle()},i.a.createElement(x.a,{position:"sticky",style:{backgroundColor:"#4D708B"}},i.a.createElement(k.a,null,t,i.a.createElement(g.a,{variant:"h6",className:e.title},"QuestBook"))),n)}},{key:"onBackButtonClick",value:function(){this.onButtonClick("")}},{key:"onButtonClick",value:function(e){this.setState({currentQuestId:e})}},{key:"getStyle",value:function(){return{background:"radial-gradient(#D6C594, #938B6A)",height:"auto",minHeight:"100vh"}}}]),t}(i.a.Component);l.a.send("VKWebAppInit"),r.a.render(i.a.createElement(D,null),document.getElementById("root"))}},[[370,1,2]]]);
//# sourceMappingURL=main.6ae79977.chunk.js.map